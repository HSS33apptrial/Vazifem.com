---
const navLinks = [
  { href: '#ana-sayfa', label: 'Ana Sayfa' },
  { href: '#nasil-calisir', label: 'Nasıl Çalışır' },
  { href: '#hizmet-saglayiciyim', label: 'Hizmet Sağlayıcıyım' },
  { href: '#iletisim', label: 'İletişim' },
];
---

<header
  id="navbar"
  class="fixed top-0 left-0 right-0 z-50 transition-all duration-300"
>
  <nav class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <div class="flex h-16 items-center justify-between lg:h-20">
      <!-- Logo -->
      <a href="#ana-sayfa" class="flex items-center gap-2 shrink-0">
        <img src="/images/logo.svg" alt="Vazifem" class="h-8 lg:h-10 w-auto" />
      </a>

      <!-- Desktop nav -->
      <div class="hidden lg:flex items-center gap-8">
        {navLinks.map((link) => (
          <a
            href={link.href}
            class="nav-link relative text-sm font-medium text-neutral-600 transition-colors duration-200 hover:text-primary-700"
            data-section={link.href.substring(1)}
          >
            {link.label}
            <span class="absolute -bottom-1 left-0 h-0.5 w-0 bg-primary-600 transition-all duration-300 rounded-full nav-underline" />
          </a>
        ))}
      </div>

      <!-- Mobile hamburger -->
      <button
        id="mobile-menu-btn"
        class="lg:hidden flex flex-col justify-center items-center w-10 h-10 gap-1.5"
        aria-label="Menüyü aç"
        aria-expanded="false"
      >
        <span class="hamburger-line block w-6 h-0.5 bg-neutral-700 transition-all duration-300 origin-center"></span>
        <span class="hamburger-line block w-6 h-0.5 bg-neutral-700 transition-all duration-300"></span>
        <span class="hamburger-line block w-6 h-0.5 bg-neutral-700 transition-all duration-300 origin-center"></span>
      </button>
    </div>
  </nav>

  <!-- Mobile menu -->
  <div
    id="mobile-menu"
    class="lg:hidden fixed inset-0 top-16 z-40 pointer-events-none opacity-0 transition-opacity duration-300"
  >
    <!-- Backdrop -->
    <div class="absolute inset-0 bg-black/20 backdrop-blur-sm" />
    <!-- Menu panel -->
    <div class="relative bg-white/95 backdrop-blur-md shadow-xl border-t border-neutral-100 translate-y-[-1rem] transition-transform duration-300">
      <div class="px-6 py-6 flex flex-col gap-4">
        {navLinks.map((link) => (
          <a
            href={link.href}
            class="mobile-nav-link text-lg font-medium text-neutral-700 py-2 transition-colors hover:text-primary-600"
            data-section={link.href.substring(1)}
          >
            {link.label}
          </a>
        ))}
      </div>
    </div>
  </div>
</header>

<style>
  /* Navbar scrolled state */
  #navbar.scrolled {
    background-color: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
  }
  #navbar:not(.scrolled) {
    background-color: transparent;
  }

  /* Active nav link */
  .nav-link.active {
    color: #15803d;
    font-weight: 600;
  }
  .nav-link.active .nav-underline {
    width: 100%;
  }

  /* Mobile menu open state */
  #mobile-menu.open {
    opacity: 1;
    pointer-events: auto;
  }
  #mobile-menu.open > div:last-child {
    transform: translateY(0);
  }

  /* Hamburger animation */
  #mobile-menu-btn.open .hamburger-line:nth-child(1) {
    transform: translateY(0.375rem) rotate(45deg);
  }
  #mobile-menu-btn.open .hamburger-line:nth-child(2) {
    opacity: 0;
  }
  #mobile-menu-btn.open .hamburger-line:nth-child(3) {
    transform: translateY(-0.375rem) rotate(-45deg);
  }

  .mobile-nav-link.active {
    color: #16a34a;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const navbar = document.getElementById('navbar');
    const menuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    const sections = document.querySelectorAll('section[id]');
    const navLinks = document.querySelectorAll('.nav-link');
    const mobileLinks = document.querySelectorAll('.mobile-nav-link');

    // Scroll: toggle navbar background
    const onScroll = () => {
      if (window.scrollY > 50) {
        navbar?.classList.add('scrolled');
      } else {
        navbar?.classList.remove('scrolled');
      }
    };
    window.addEventListener('scroll', onScroll, { passive: true });
    onScroll();

    // Mobile menu toggle
    menuBtn?.addEventListener('click', () => {
      const isOpen = mobileMenu?.classList.toggle('open');
      menuBtn.classList.toggle('open');
      menuBtn.setAttribute('aria-expanded', String(isOpen));
    });

    // Close mobile menu on link click
    mobileLinks.forEach((link) => {
      link.addEventListener('click', () => {
        mobileMenu?.classList.remove('open');
        menuBtn?.classList.remove('open');
        menuBtn?.setAttribute('aria-expanded', 'false');
      });
    });

    // Active section highlighting
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            const id = entry.target.id;
            navLinks.forEach((link) => {
              const isActive = link.getAttribute('data-section') === id;
              link.classList.toggle('active', isActive);
            });
            mobileLinks.forEach((link) => {
              const isActive = link.getAttribute('data-section') === id;
              link.classList.toggle('active', isActive);
            });
          }
        });
      },
      { rootMargin: '-20% 0px -75% 0px' }
    );
    sections.forEach((section) => observer.observe(section));
  });
</script>
